<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
   <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <!-- Favicon -->
  <link href="../images/vl_blue.ico" type="image/x-icon" rel="icon"></link>
  <link href="../images/vl_blue.ico" type="image/x-icon" rel="shortcut icon"></link>
  <!-- Page title -->
  <title>VLFeat - Documentation - C API</title>
  <!-- Stylesheets -->
  <link href="../vlfeat.css" type="text/css" rel="stylesheet"></link>
  <link href="../pygmentize.css" type="text/css" rel="stylesheet"></link>
  <style xml:space="preserve">
    /* fixes a conflict between Pygmentize and MathJax */
    .MathJax .mo, .MathJax .mi {color: inherit ! important}
  </style>
  <link rel="stylesheet" type="text/css" href="doxygen.css"></link>
  <!-- Scripts-->
  <script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
  <!-- MathJax -->
  <script xml:space="preserve" type="text/x-mathjax-config">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      processEscapes: true,
    },
    TeX: {
      Macros: {
        balpha: '\\boldsymbol{\\alpha}',
        bc: '\\mathbf{c}',
        be: '\\mathbf{e}',
        bg: '\\mathbf{g}',
        bq: '\\mathbf{q}',
        bu: '\\mathbf{u}',
        bv: '\\mathbf{v}',
        bw: '\\mathbf{w}',
        bx: '\\mathbf{x}',
        by: '\\mathbf{y}',
        bz: '\\mathbf{z}',
        bsigma: '\\mathbf{\\sigma}',
        sign: '\\operatorname{sign}',
        diag: '\\operatorname{diag}',
        real: '\\mathbb{R}',
      },
      equationNumbers: { autoNumber: 'AMS' }
      }
    });
  </script>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" xml:space="preserve" type="text/javascript"></script>
  <!-- Google Custom Search -->
  <script xml:space="preserve">
    (function() {
    var cx = '003215582122030917471:oq23albfeam';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
    '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
    })();
  </script>
  <!-- Google Analytics -->
  <script xml:space="preserve" type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4936091-2']);
    _gaq.push(['_trackPageview']);
    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
 </head>
 <!-- Body Start -->
 <body>
  <div id="header-section">
    <div id="header">
      <!-- Google CSE Search Box -->
      <div id="google" class="gcse-searchbox-only" data-resultsUrl="http://www.vlfeat.org/search.html"></div>
      <h1 id="id-13"><a shape="rect" href="../index.html" class="plain"><span id="vlfeat">VLFeat</span><span id="dotorg">.org</span></a></h1>
    </div>
  </div>
  <div id="headbanner-section">
    <div id="headbanner">
      Documentation - C API
    </div>
  </div>
  <div id="content-section">
    <div id="content-wrapper">
      <div id="sidebar"> <!-- Navigation Start -->
        <ul>
<li><a href="../index.html">Home</a>
</li>
<li><a href="../download.html">Download</a>
</li>
<li><a href="../overview/tut.html">Tutorials</a>
</li>
<li><a href="../applications/apps.html">Applications</a>
</li>
<li><a href="../doc.html">Documentation</a>
<ul>
<li><a href="../matlab/matlab.html">Matlab API</a>
</li>
<li><a href="index.html" class='active' >C API</a>
</li>
<li><a href="../man/man.html">Man pages</a>
</li>
</ul></li>
</ul>
      </div> <!-- sidebar -->
      <div id="content">
      <!-- <pagestyle href="%pathto:root;api/tabs.css"/> -->
      <div class="doxygen">
<div id="top">
<!-- Generated by Doxygen 1.8.1.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Vision Lab Features Library (VLFeat)</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Gaussian Scale Space (GSS) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#scalespace-overview">Overview</a><ul><li class="level2"><a href="#scalespace-finer">Finer control</a></li>
</ul>
</li>
<li class="level1"><a href="#scalespace-algorithm">Algorithm and limitations</a></li>
</ul>
</div>
<div class="textblock"><dl class="section author"><dt>Author:</dt><dd>Karel Lenc </dd>
<dd>
Andrea Vedaldi </dd>
<dd>
Michal Perdoch</dd></dl>
<p><a class="el" href="scalespace_8h.html">scalespace.h</a> implements a Gaussian scale space, a data structure representing an image at multiple resolutions <a class="el" href="citelist.html#CITEREF_witkin83scale-space">[27]</a> <a class="el" href="citelist.html#CITEREF_koenderink84the-structure">[10]</a> <a class="el" href="citelist.html#CITEREF_lindeberg94scale-space">[11]</a> . Scale spaces are used, for example, to detect scale invariant features <a class="el" href="citelist.html#CITEREF_lindeberg98principles">[12]</a> such as SIFT, Hessian-Affine, Harris-Affine, Harris-Laplace, etc.</p>
<h1><a class="anchor" id="scalespace-overview"></a>
Overview</h1>
<p>A <em>scale space</em> is representation of an image at multiple resolution levels. An image is a function \(\ell(x,y)\) of two coordinates \(x\), \(y\); the scale space \(\ell(x,y,\sigma)\) adds a third coordinate \(\sigma\) indexing the <em>scale</em>. <a class="el" href="scalespace_8h.html">scalespace.h</a> implements in particular the Gaussian scale space, where the image \(\ell(x,y,\sigma)\) is obtained by smoothing \(\ell(x,y)\) by a Gaussian kernel of isotropic standard deviation \(\sigma\).</p>
<p>In practice, the spatial coordiantes \((x,y)\) and the scale coordinate \(\sigma\) are sampled. The density of the spatial sampling is adjusted as a function of the scale: intuitively, coarser resolution images can be sampled more coarsely. Thus, the scale space has the structure of a <em>pyramid</em>: a collection of images of progressively coarser resolution and smaller size (in pixels).</p>
<p>The pyramid is organised in a number of <em>octaves</em>, indexed by a parameter <code>o</code>, and further <em>sublevels</em> for each octave, indexed by a parameter <code>s</code>. These are related to the scale \(\sigma\) by</p>
<p class="formulaDsp">
\[ \sigma(s,o) = \sigma_o 2^{\displaystyle o + \frac{s}{\mathtt{octaveResolution}}} \]
</p>
<p>where <code>octaveResolution</code> is the resolution of the octave subsampling \(\sigma_0\) is the <em>base smoothing</em>.</p>
<p>Given an input image <code>image</code>, the following example uses the <a class="el" href="structVlScaleSpace.html" title="Scale space class.">VlScaleSpace</a> object to compute the image <code>level</code>, which is the version of <code>image</code> at scales <code>(o,s)</code>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">float</span>* level ;</div>
<div class="line"><a class="code" href="structVlScaleSpace.html" title="Scale space class.">VlScaleSpace</a> ss = <a class="code" href="scalespace_8c.html#a42931ebe6e7e762b7d0ccd7856d97834" title="Create a new scale space object.">vl_scalespace_new</a>(imageWidth, imageHeight) ;</div>
<div class="line"><a class="code" href="scalespace_8c.html#a2e2be28c7c1017222fec22a8c0df02f5" title="Initialise Scale space with new image.">vl_scalespace_put_image</a>(ss, image) ;</div>
<div class="line">level = <a class="code" href="scalespace_8c.html#a5010e154df5b981f31afff3af704ae30" title="Get the data of a scale space level.">vl_scalespace_get_level</a>(ss, o, s) ;</div>
</div><!-- fragment --><p>Note that <code>level</code> has not necessarily the same dimensions or sampling density of <code>image</code>. The geometry of <code>level</code> can be obtained as</p>
<div class="fragment"><div class="line"><a class="code" href="structVlScaleSpaceOctaveGeometry.html" title="Geometry of one octave of a scale space.">VlScaleSpaceOctaveGeometry</a> ogeom = <a class="code" href="scalespace_8c.html#a5c63aee8d9c6e9393308eb3306264108" title="Get the geometry of an octave of the scalespace.">vl_scalespace_get_octave_geometry</a>(ss, o) ;</div>
<div class="line">ogeom.<a class="code" href="structVlScaleSpaceOctaveGeometry.html#a6453dbc6d4d71f937f6f33ba47305ffd">width</a> \\ width of level (in number of pixels)</div>
<div class="line">ogeom.<a class="code" href="structVlScaleSpaceOctaveGeometry.html#a3213379847cead09269f075d6605dda1">height</a> \\ height of level (in number of pixels)</div>
<div class="line">ogeom.<a class="code" href="structVlScaleSpaceOctaveGeometry.html#a4138bb23b20fa0d96b98027243b79816">step</a> \\ spatial sampling step</div>
</div><!-- fragment --><p>This means that \(\ell(x,y,\sigma) = \mathtt{level}[i,j]\), where </p>
<p class="formulaDsp">
\[ x = \mathtt{ogeom.step} \times i, \quad 0 \leq i &lt; \mathtt{ogeom.width}, \]
</p>
<p>and similarly for \(y\). The other impotant information in order to use scale space is to know the range of the paramerters <code>o</code> and <code>s</code>. This can be obtained as</p>
<div class="fragment"><div class="line"><a class="code" href="structVlScaleSpaceGeometry.html" title="Geometry of a scale space.">VlScaleSpaceGeometry</a> geom = vl_scalespace_get_geomerty(ss) ;</div>
</div><!-- fragment --><p>So for example <code>o</code> varies in the range from <code>geom.firstOctave</code> to <code>geom.lastOctave</code> and <code>s</code> in the range <code>geom.octaveFirstSubdivision</code> to <code>geom.octaveLastSubdivision</code>.</p>
<h2><a class="anchor" id="scalespace-finer"></a>
Finer control</h2>
<p><a class="el" href="structVlScaleSpace.html" title="Scale space class.">VlScaleSpace</a> offers more control on how the pyramid is constructed. Two usage cases are the following:</p>
<ul>
<li>In feature detection it is often convenient to sample a few redudant sublevels per octave, effectively representing the same scale with two different spatial samplings. This simplifies detecting extrema in scales at boundary scale levels.</li>
</ul>
<ul>
<li>Often there is a convenience in oversampling (at more than the Nyquist frequency) the finer scales. While oversampling does not add information to the image, it may simplify significantly the implementation of filers such as derivatives.</li>
</ul>
<p>All this is possible by using a more advanced interface to <a class="el" href="structVlScaleSpace.html" title="Scale space class.">VlScaleSpace</a>. For example, in oerder to start sampling at octave -1 and have two redundant subdivisions per octave, one can use:</p>
<div class="fragment"><div class="line"><a class="code" href="structVlScaleSpaceGeometry.html" title="Geometry of a scale space.">VlScaleSpaceGeometry</a> geom = <a class="code" href="scalespace_8c.html#ab9a838a41d9fe1e04f1477061055b6d9" title="Get the default geometry for a given image size.">vl_scalespace_get_default_geometry</a>(imageWidth, imageHeight) ;</div>
<div class="line">geom.<a class="code" href="structVlScaleSpaceGeometry.html#a96805e209d1452bfb9aa36b9269efcfc">firstOctave</a> = -1 ;</div>
<div class="line">geom.<a class="code" href="structVlScaleSpaceGeometry.html#a6336d051b8aa479fe3085c9fde98db66">octaveFirstSubdivision</a> = -1 ;</div>
<div class="line">geom.<a class="code" href="structVlScaleSpaceGeometry.html#a0bff7bc6133eabbfb78b1c1c96bc3fa2">octaveLastSubdivision</a> = geom.<a class="code" href="structVlScaleSpaceGeometry.html#a1ce73bc970c420bd4c93154727edd16d">octaveResolution</a> ;</div>
<div class="line">VlScaleSpacae ss = <a class="code" href="scalespace_8c.html#a6e997ce733e67a186769e2877a5aaa6a" title="Create a new scale space with the specified geometry.">vl_scalespace_new_with_geometry</a> (geom) ;</div>
</div><!-- fragment --><h1><a class="anchor" id="scalespace-algorithm"></a>
Algorithm and limitations</h1>
<p>Formally, the <em>Gaussian scale space</em> of an image \(\ell(x,y)\) is defined as</p>
<p class="formulaDsp">
\[ \ell(x,y,\sigma) = [g_{\sigma} * \ell](x,y,\sigma) \]
</p>
<p>where \(g_\sigma\) denotes a 2D Gaussian kernel of isotropic standard deviation \(\sigma\):</p>
<p class="formulaDsp">
\[ g_{\sigma}(x,y) = \frac{1}{2\pi\sigma^2} \exp\left( - \frac{x^2 + y^2}{2\sigma^2} \right). \]
</p>
<p>An important detail is that the algorithm is not fed with the dieal infinite resolution image \(\ell(x,y)\), but with a pre-smoothed and sampled version measured by the CCD. This is modelled by assuming that the input is in fact the sampled image \(\ell(x,y,\sigma_n)\), where \(\sigma_n\) is a <em>nominal smoothing</em>, usually taken to be 0.5 (half a pixel standard deviation). This also means that \(\sigma = \sigma_n = 0.5\) is the <em>finest scale</em> that can actually be computed.</p>
<p>Given \(\ell(x,y,\sigma_n)\), any of a vast number digitial filtering techniques can be used to compute the succesive scales. Presently, <a class="el" href="structVlScaleSpace.html" title="Scale space class.">VlScaleSpace</a> uses a basic FIR implementation of the Gaussian filters.</p>
<p>The FIR implementation is obtained by sampling the Gaussian function and re-normalizing it to have unit norm. As a rule of thumb, such a filter works sufficiently well for, say, feature detection if the standard deviation \(\sigma\) is at least 1.6 times the spatial sampling step. The same filter works better still the input image is oversampled.</p>
<p>The limitations on the FIR filters have impliciations on the pyramid itself, as the latter is constructed by <em>incremental smoothing</em>: each successive level is obtained from the previous one by adding the needed amount of smoothing. In this manner, the size of the FIR filters remains small; however, if the scale sublevels are too packed, the incremental smoothing is so small that the FIR implementation may break. </p>
</div></div><!-- contents -->
        <!-- Doc Here -->
      </div>
      </div>
      <div class="clear">&nbsp;</div>
    </div>
  </div> <!-- content-section -->
  <div id="footer-section">
    <div id="footer">
      &copy; 2007-13 The authors of VLFeat
    </div> <!-- footer -->
  </div> <!-- footer section -->
 </body>
 <!-- Body ends -->
</html>
